<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
  <!-- layout 居中， 左右auto  -->
  <div class="container">
    <!-- 一行 -->
    <div class="row">
      <div class="col-md-6">
        <form action="https://www.baidu.com" name="appForm">
          <div class="form-group">
            <label for="titleInput">Bot名称：</label>
            <input placeholder="请输入名称" id="titleInput" name="title" type="text" required class="form-control">
          </div>
          <div class="form-group">
            <label for="descInput">Bot描述：</label>
            <textarea name="desc" placeholder="请输入描述" class="form-control" id="descInput" rows="3"></textarea>
          </div>
          <div class="form-group">
            <button type="submit" class="btn btn-default btn-primary" id="submitBtn">生成图标</button>
          </div>
        </form>
      </div>
    </div>
    <!-- DOM 动态插入log appenchild -->
    <div class="row" id="logo-container"></div>
  </div>
  <script>
    // form 可以用name来查找
    // document里会自动的讲表单作为集合处理
    const oForm = document.forms["appForm"];
    // console.log(oForm);
    // 事件处理函数
    oForm.addEventListener("submit", function (event) {
      // 事件处理函数
      event.preventDefault()
      // 清空之前的Logo
      document.querySelector('#logo-container').innerHTML = '';
      
      // js this 可滑头了， 72变
      // 事件处理函数，this 指向当前事件的目标元素
      // js 一周开发出来的语言
      console.log(this);

      const appName = this["title"].value;
      // console.log(appName);
      const appDesc = this["desc"].value;
      // prompt
      const prompt = `
    你是一个互联网大厂的设计师，需要设计一个移动应用的logo。
    应用名称为${appName},
    描述为${appDesc}。
    设计一个高端、大气、上档次的logo。
    请确保设计方案适用于移动应用图标 (App Icon)。
    `
      // console.log(prompt);
      //请求方法
      // 显示加载状态
      const logoContainer = document.querySelector('#logo-container');
      const loadingDiv = document.createElement('div');
      loadingDiv.className = 'alert alert-info';
      loadingDiv.textContent = '正在生成Logo，请稍候...';
      logoContainer.appendChild(loadingDiv);
      
      // 由于CORS限制，我们使用模拟数据演示功能
      // 在实际生产环境中，您需要配置服务器端代理或使用支持CORS的API
      setTimeout(() => {
        // 移除加载提示
        logoContainer.removeChild(loadingDiv);
        
        // 创建图片容器
        const imgContainer = document.createElement('div');
        imgContainer.className = 'col-md-4';
        
        // 使用随机图片服务模拟生成的Logo
        const img = document.createElement('img');
        img.src = `https://picsum.photos/seed/${appName}${Date.now()}/1024/1024.jpg`;
        img.className = 'img-responsive img-thumbnail';
        img.alt = `${appName} Logo`;
        
        img.onload = function() {
          imgContainer.appendChild(img);
          logoContainer.appendChild(imgContainer);
          
          // 添加说明信息
          const infoDiv = document.createElement('div');
          infoDiv.className = 'alert alert-warning';
          infoDiv.innerHTML = `
            <strong>注意：</strong>由于CORS限制，此处显示的是模拟图片。<br>
            在实际应用中，您需要：<br>
            1. 配置服务器端代理来调用API<br>
            2. 或使用支持CORS的API服务<br>
            3. 或将应用部署到与API相同域名的服务器上
          `;
          logoContainer.appendChild(infoDiv);
        };
        
        img.onerror = function() {
          // 如果图片加载失败，显示错误信息
          const errorDiv = document.createElement('div');
          errorDiv.className = 'alert alert-danger';
          errorDiv.innerHTML = `
            <strong>生成Logo失败！</strong><br>
            错误信息: 无法加载图片<br>
            <small>提示：请检查网络连接或API配置。</small>
          `;
          logoContainer.appendChild(errorDiv);
        };
      }, 2000); // 模拟API请求延迟
    })
  </script>
</body>

</html>